import pandas,numpy,matplotlib.pyplot
matplotlib.pyplot.scatter(x,y,c='red')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 30))
matplotlib.pyplot.xticks(rotation=90)
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y)
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='*')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='x')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='v')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='^')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='o')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='1')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='|')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='>')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='<')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker=',')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='.')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
# Change the default figure size
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='+')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
# Change the default figure size
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.scatter(x,y, c='red', marker='_')
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.xlabel ("Date", fontsize = 24)
matplotlib.pyplot.ylabel ("Mean Temperature", fontsize = 24)
matplotlib.pyplot.title('Mean Temperature at Jaipur', fontsize = 30)
matplotlib.pyplot.xticks (fontsize = 12)
matplotlib.pyplot.yticks (fontsize = 12)
matplotlib.pyplot.xticks (rotation=30, horizontalalignment='right')
matplotlib.pyplot.show()
colors = numpy.random.rand(len(y)) # Create random value
matplotlib.pyplot.scatter(x,y,c=colors,alpha=0.5)
matplotlib.pyplot.show()
x = dataframe.date
y_1 = dataframe.max_temperature
y_2 = dataframe.min_temperature
y_3 = dataframe.mean_temperature
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.plot(x,y_1, label = "Max temp") 
matplotlib.pyplot.plot(x,y_2, label = "Min temp") 
matplotlib.pyplot.plot(x,y_3, label = "Mean temp") 
matplotlib.pyplot.xticks(numpy.arange(0, 731, 60))
matplotlib.pyplot.xticks (rotation=30)
matplotlib.pyplot.legend()
matplotlib.pyplot.show()
import matplotlib.pyplot
objects = ('Python', 'C++', 'Java', 'Perl', 'Scala', 'Lisp')
y_pos = numpy.arange(len(objects))
usage = [10,8,6,4,2,1]
matplotlib.pyplot.bar(y_pos, usage, align='center')
matplotlib.pyplot.xticks(y_pos, objects) # name the xticks 
matplotlib.pyplot.show()
x = dataframe.date
y = dataframe.mean_temperature
fig, (ax1, ax2,ax3,ax4) = matplotlib.pyplot.subplots(1, 4,  sharey=True) #create 2 subplots with shared y axis
fig.suptitle('Sharing Y axis')
ax1.plot(x, y)
ax2.scatter(x, y)
ax3.boxplot(y)
ax4.hist(y)
matplotlib.pyplot.show()
x = dataframe.date
y = dataframe.mean_temperature
fig, (ax1, ax2,ax3,ax4) = matplotlib.pyplot.subplots(1, 4,  sharex=True) #create 2 subplots with shared y axis
fig.suptitle('Sharing X axis')
ax1.plot(x, y)
ax2.scatter(x, y)
ax3.boxplot(y)
ax4.hist(y)
matplotlib.pyplot.show()
objects = ('','Auckland','Christchurch','Dunedin','Hamilton','Wellington')
y_pos = numpy.arange(len(objects))
matplotlib.pyplot.figure(figsize=(10,10))
matplotlib.pyplot.boxplot(yy)
matplotlib.pyplot.xticks(y_pos,objects)
matplotlib.pyplot.show()
import matplotlib.pyplot,numpy
x = numpy.linspace(0,10,100)
y = numpy.sin(x)
y1 = numpy.cos(x)
y2 = numpy.tan(x)
y3 = numpy.tanh(x)
y4 = numpy.sinc(x)
y5 = numpy.sinh(x)
y6 = numpy.cosh(x)
fig ,(ax1,ax2,ax3,ax4,ax5,ax6,ax7) = matplotlib.pyplot.subplots(1,7,figsize=(50,50))
ax1.plot(x,y)
ax2.plot(x,y1)
ax3.plot(x,y2)
ax4.plot(x,y3)
ax5.plot(x,y4)
ax6.plot(x,y5)
ax7.plot(x,y6)
matplotlib.pyplot.show()
X1 = [4,1,5,7]
print(X1)
X1[2] = 10
print(X1)
X1 = [i + 2 for i in X1]
print(X1)
dataset = [2, 1, 1, 4, 5, 8, 12, 4, 3, 8, 21, 1, 18, 5]
number_of_items = len(dataset)
print(number_of_items)
sum_of_items = sum(dataset)
print(sum_of_items)
mean = sum_of_items/number_of_items
print(mean)
dataset = sorted(dataset)
print(dataset)
middle_index = len(dataset)//2
print (middle_index)
median = dataset[middle_index] + dataset[middle_index-1]
median = median/2
print (median)
mode = max(dataset,key=dataset.count)
print (mode)
print('at:',df.at)
print('axes:')
print(df.axes)
print('attrs:',df.attrs)
print('columns:')
print(df.columns)
print('class:',df.__class__)
print('cov:')
print(df.cov())
print('corr:')
print(df.corr())
print('count:')
print(df.count())
print('cummin:')
print(df.cummin())
print('cummax:')
print(df.cummax())
print('cumsum:')
print(df.cumsum())
print('cumprod:')
print(df.cumprod())
print('diff:')
print(df.diff())
print('dtypes:')
print(df.dtypes)
print('describe:')
print(df.describe())
print('dict:',df.__dict__)
print('doc:',df.__doc__)
print('empty:',df.empty)
print('expanding:')
print(df.expanding())
print('flag:',df.flags)
print('first valid index:',df.first_valid_index())
print('head:')
print(df.head())
print('hash:',df.__hash__)
print('hist:')
print(df.hist())
print('iat:')
print(df.iat)
print('info:')
print(df.info())
print('isna:')
print(df.isna())
print('isnull:')
print(df.isnull())
print('iloc:',df.iloc)
print('index:',df.index)
print('loc:',df.loc)
print('idxmin:',df.idxmin())
print('idxmax:',df.idxmax())
print('items:',df.items())
print('iterrows:',df.iterrows())
print('itertuples:',df.itertuples())
print('keys:')
print(df.keys())
print('kurt:')
print(df.kurt())
print('kurtosis')
print(df.kurtosis())
print('last valid index:',df.last_valid_index())
print('melt:')
print(df.melt())
print('memory usage:')
print(df.memory_usage())
print('min:')
print(df.min())
print('max:')
print(df.max())
print('mean:')
print(df.mean())
print('median:')
print(df.median())
print('mode:')
print(df.mode())
print('module:',df.__module__)
print('to numpy:')
print(df.to_numpy())
print('notna:')
print(df.notna())
print('notnull:')
print(df.notnull())
print('nunique:')
print(df.nunique())
print('ndim:',df.ndim)
print('pct change:')
print(df.pct_change())
print('prod:')
print(df.prod())
print('product:')
print(df.product())
print('array priority:',df.__array_priority__)
print('plot:',df.plot())
print('quantile:')
print(df.quantile())
print('rank:')
print(df.rank())
print('round:')
print(df.round())
print('sample:')
print(df.sample())
print('sem:')
print(df.sem())
print('shift:')
print(df.shift())
print('skew:')
print(df.skew())
print('stack:')
print(df.stack())
print('std:')
print(df.std())
print('sum:')
print(df.sum())
print('shape:',df.shape)
print('size:',df.size)
print('style:',df.style)
print('tail:')
print(df.tail())
print('T:')
print(df.T)
print('to xarray:',df.to_xarray())
print('unstack:')
print(df.unstack())
print('values:')
print(df.values)
print('var:')
print(df.var())
df_Setosa = df[df['class'] == 'Iris-setosa']
df_Versicolor = df[df['class'] == 'Iris-versicolor']
df_Virginica = df[df['class'] == 'Iris-virginica']
matplotlib.pyplot.figure(figsize=(20,20))
matplotlib.pyplot.scatter(df_Setosa['petal length'],df_Setosa['petal width'], label = "Setosa") 
matplotlib.pyplot.scatter(df_Versicolor['petal length'],df_Versicolor['petal width'], label = "Versicolor") 
matplotlib.pyplot.scatter(df_Virginica['petal length'],df_Virginica['petal width'], label = "Virginica") 
matplotlib.pyplot.legend()
matplotlib.pyplot.show()
fig,(ax,ax1,ax2,ax3) = matplotlib.pyplot.subplots(1,4,figsize=(10,10),sharex=True)
ax.boxplot(df['sepal width'])
ax1.boxplot(df['petal length'])
ax2.boxplot(df['petal width'])
ax3.boxplot(df['sepal width'])
matplotlib.pyplot.show()
fig,(ax,ax1,ax2,ax3) = matplotlib.pyplot.subplots(1,4,figsize=(10,10),sharey=True)
ax.boxplot(df['sepal width'])
ax1.boxplot(df['petal length'])
ax2.boxplot(df['petal width'])
ax3.boxplot(df['sepal width'])
matplotlib.pyplot.show()
fig,(ax,ax1,ax2,ax3) = matplotlib.pyplot.subplots(1,4,figsize=(10,10),sharex=True)
ax.hist(df['sepal width'])
ax1.hist(df['petal length'])
ax2.hist(df['petal width'])
ax3.hist(df['sepal width'])
matplotlib.pyplot.show()
fig,(ax,ax1,ax2,ax3) = matplotlib.pyplot.subplots(1,4,figsize=(10,10),sharey=True)
ax.hist(df['sepal width'])
ax1.hist(df['petal length'])
ax2.hist(df['petal width'])
ax3.hist(df['sepal width'])
matplotlib.pyplot.show()
import pandas,matplotlib.pyplot
df = pandas.read_csv("./data/iris.data",header=None)
df = df.rename(columns={0:'sepal length',1:'sepal width',2:'petal length',3:'petal width',4:'class'})
c0,c1,c2 = df['class'].value_counts()
c0 = df[df['class'] == 'Iris-setosa']
print(c0)
c1 = df[df['class'] == 'Iris-virginica']
print(c1)
c2 = df[df['class'] == 'Iris-versicolor']
print(c2)
ni = [-1] + list(df.index)
df = df.reindex(ni)
df.loc[-1] = ['sepal length','sepal width','petal length','petal width','class']
print(df)
print(df['class'].value_counts())
label_encode = {"class": {"Iris-setosa":1}}
label_encode1 = {"class": {"Iris-versicolor":2}}
label_encode2 = {"class": {"Iris-virginica":3}}
df.replace(label_encode,inplace=True)
df.replace(label_encode1,inplace=True)
df.replace(label_encode2,inplace=True)
KNN2 = KNeighborsClassifier()
x1 = df.drop(columns='class',axis=1)
y1 = df['class']
print(x1.head())
print(y1.head())
KNN2.fit(x1,y1)
test5 = pandas.DataFrame()
test5['sepal length'] = [5]
test5['sepal width'] = [3]
test5['petal length'] = [5]
test5['petal width'] = [2]
predict_flower4 = KNN2.predict(test5)
if predict_flower4 == 1:
    print('iris-setosa')
elif predict_flower4 == 2:
    print('iris-versicolor')
else:
    print('iris-virginica')
dt1 = tree.DecisionTreeClassifier()
x4 = df.drop(columns='class',axis=1)
y = df['class']
print(x4.head())
print(y.head())
dt1 = dt1.fit(x4,y)
test8 = pandas.DataFrame()
test8['sepal length'] = [5.8]
test8['sepal width'] = [2.3]
test8['petal length'] = [5]
test8['petal width'] = [1.3]
predict_flower7 = dt1.predict(test8)
if predict_flower7 == 1:
    print('iris-setosa')
elif predict_flower7 == 2:
    print('iris-versicolor')
else:
    print('iris-virginica')
df[(df[['Mathematics score', 'English score', 'Science score']] < 0).any(axis=1)|(df[['Mathematics score', 'English score', 'Science score']] >100).any(axis=1)]
df[(df['Mathematics score']<0)|(df['Mathematics score']>100)]
flower_types = []
for ii in range(0,y_new.shape[0]):
    flower_types.append(numpy.argmax(y_new[ii,:]))
print(flower_types)
for i in range(len(flower_types)):
    if flower_types[i]==0:
        flower_types[i]='Iris-Setosa'
    if flower_types[i]==1:
        flower_types[i]='Iris-Versicolor'
    if flower_types[i]==2:
        flower_types[i]='Iris-Verginica'
print(flower_types)
a = loan[loan['Personal Loan']==0]
b= loan[loan['Personal Loan']==1]
c = b.sample(n=len(a),replace=True)
len(c)
df = df['open'].values
df = df.reshape(-1, 1)
print(df.shape)
df[:5]
dataset_train = numpy.array(df[:int(df.shape[0]*0.8)])
dataset_test = numpy.array(df[int(df.shape[0]*0.8)-50:])
print(dataset_train.shape)
print(dataset_test.shape)
scaler = MinMaxScaler(feature_range=(0,1))
dataset_train = scaler.fit_transform(dataset_train)
dataset_train[:5]
dataset_test = scaler.transform(dataset_test)
dataset_test[:5]
def create_dataset(df):
    x = []
    y = []
    for i in range(50, df.shape[0]):
        x.append(df[i-50:i, 0])
        y.append(df[i, 0])
    x = numpy.array(x)
    y = numpy.array(y)
    return x,y 
#Reshape features for LSTM Layer
x_train = numpy.reshape(x_train, (x_train.shape[0], x_train.shape[1], 1))
x_test = numpy.reshape(x_test, (x_test.shape[0], x_test.shape[1], 1))
model = tensorflow.keras.models.Sequential()
model.add(tensorflow.keras.layers.LSTM(units=96, return_sequences=True, input_shape=(x_train.shape[1], 1)))
model.add(tensorflow.keras.layers.Dropout(0.2))
model.add(tensorflow.keras.layers.LSTM(units=96, return_sequences=True))
model.add(tensorflow.keras.layers.Dropout(0.2))
model.add(tensorflow.keras.layers.LSTM(units=96, return_sequences=True))
model.add(tensorflow.keras.layers.Dropout(0.2))
model.add(tensorflow.keras.layers.LSTM(units=96))
model.add(tensorflow.keras.layers.Dropout(0.2))
model.add(tensorflow.keras.layers.Dense(units=1))
matplotlib.pyplot.figure(figsize=(10,5))
matplotlib.pyplot.subplot(1,4,1)
matplotlib.pyplot.plot(a.history['Accuracy'], label='Train Accuracy')
matplotlib.pyplot.plot(a.history['Precision'],label='Train Precision')
matplotlib.pyplot.plot(a.history['Recall'],label='Train Recall')
matplotlib.pyplot.title('Output')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy,Precision,Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,2)
matplotlib.pyplot.plot(a.history['Accuracy'], label='Train Accuracy')
matplotlib.pyplot.title('Output Accuracy')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,3)
matplotlib.pyplot.plot(a.history['Precision'],label='Rain Precision')
matplotlib.pyplot.title('Output Precision')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Precision')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,4)
matplotlib.pyplot.plot(a.history['Recall'],label='Train Recall')
matplotlib.pyplot.title('Output Recall')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.tight_layout()
matplotlib.pyplot.figure(figsize=(10,5))
matplotlib.pyplot.subplot(1,4,1)
matplotlib.pyplot.boxplot(a.history['Accuracy'])
matplotlib.pyplot.boxplot(a.history['Precision'])
matplotlib.pyplot.boxplot(a.history['Recall'])
matplotlib.pyplot.title('Output')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy,Precision,Recall')
matplotlib.pyplot.subplot(1,4,2)
matplotlib.pyplot.boxplot(a.history['Accuracy'])
matplotlib.pyplot.title('Output Accuracy')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy')
matplotlib.pyplot.subplot(1,4,3)
matplotlib.pyplot.boxplot(a.history['Precision'])
matplotlib.pyplot.title('Output Precision')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Precision')
matplotlib.pyplot.subplot(1,4,4)
matplotlib.pyplot.boxplot(a.history['Recall'])
matplotlib.pyplot.title('Output Recall')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Recall')
matplotlib.pyplot.tight_layout()
matplotlib.pyplot.figure(figsize=(10,5))
matplotlib.pyplot.subplot(1,4,1)
matplotlib.pyplot.bar(a.history['Accuracy'],len(a.history['Accuracy']), label='Train Accuracy')
matplotlib.pyplot.bar(a.history['Precision'],len(a.history['Precision']),label='Train Precision')
matplotlib.pyplot.bar(a.history['Recall'],len(a.history['Recall']),label='Train Recall')
matplotlib.pyplot.title('Output')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy,Precision,Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,2)
matplotlib.pyplot.bar(a.history['Accuracy'],len(a.history['Accuracy']), label='Train Accuracy')
matplotlib.pyplot.title('Output Accuracy')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,3)
matplotlib.pyplot.bar(a.history['Precision'],len(a.history['Precision']),label='Train Precision')
matplotlib.pyplot.title('Output Precision')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Precision')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,4)
matplotlib.pyplot.bar(a.history['Recall'],len(a.history['Recall']),label='Train Recall')
matplotlib.pyplot.title('Output Recall')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.tight_layout()
matplotlib.pyplot.figure(figsize=(10,5))
matplotlib.pyplot.subplot(1,4,1)
matplotlib.pyplot.hist(a.history['Accuracy'], label='Train Accuracy')
matplotlib.pyplot.hist(a.history['Precision'],label='Train Precision')
matplotlib.pyplot.hist(a.history['Recall'],label='Train Recall')
matplotlib.pyplot.title('Output')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy,Precision,Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,2)
matplotlib.pyplot.hist(a.history['Accuracy'], label='Train Accuracy')
matplotlib.pyplot.title('Output Accuracy')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Accuracy')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,3)
matplotlib.pyplot.hist(a.history['Precision'],label='Train Precision')
matplotlib.pyplot.title('Output Precision')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Precision')
matplotlib.pyplot.legend()
matplotlib.pyplot.subplot(1,4,4)
matplotlib.pyplot.hist(a.history['Recall'],label='Train Recall')
matplotlib.pyplot.title('Output Recall')
matplotlib.pyplot.xlabel('Epochs')
matplotlib.pyplot.ylabel('Recall')
matplotlib.pyplot.legend()
matplotlib.pyplot.tight_layout()
Counter(yy)
orr = RandomOverSampler()
xor,yor = orr.fit_resample(xx,yy)
srr = RandomUnderSampler()
xur,yur = srr.fit_resample(xx,yy)
seaborn.set(rc = {'figure.figsize':(10,10)},font_scale = 2)
matplotlib.pyplot.pie([len(df[df['target']==0]),len(df[df['target']==1])],labels=[0,1],autopct='%1.1f%%')
df.plot(kind='hist','area','line','kde','density',subplots='true',figsize=(10,10),fontsize='5')
from sklearn.datasets import load_iris
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
data = load_iris()
X, y = data.data, data.target
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
rf = RandomForestClassifier(oob_score=True, random_state=42)
rf.fit(X_train, y_train)
oob_error = 1 - rf.oob_score_
print(f'OOB Error: {oob_error}')
test_accuracy = rf.score(X_test, y_test)
print(f'Test Set Accuracy: {test_accuracy}')
df[(df['slope']==0)&(df['target']==1)],df[(df['slope']==1)&(df['target']==1)],df[(df['slope']==2)&(df['target']==1)]
matplotlib.rcParams.update({'axes.labelcolor':'white'})
import time,numpy,h5py,os;arr = numpy.random.randn(1000)
with h5py.File('groups.hdf5', 'w') as f:
    g = f.create_group('Base_Group');d = g.create_dataset('default', data=arr);g.attrs['Date'] = time.time();g.attrs['User'] = 'Me';d.attrs['OS'] = os.name
    for k in g.attrs.keys():print('{} => {}'.format(k, g.attrs[k]))
    for j in d.attrs.keys():print('{} => {}'.format(j, d.attrs[j]))
    print('d : ',d)
    print('g : ',g)
    print('f : ',f)
    print('k : ',k)
    print('j : ',j)
    print('arr : ',arr)
    print('keys : ',f.keys())
    print('id :',f.id)
    print('drver : ',f.driver)
    print('attrs : ',f.attrs)
    print('item : ',f.items())
    print('values : ',f.values())
    print('libver : ',f.libver)
    print('meta block size : ',f.meta_block_size)
    print('mode : ',f.mode)
    print('parent : ',f.parent)
    print('ref : ',f.ref)
    print('regionref : ',f.regionref)
    print('flush : ',f.flush())
    print('swmr mode :',f.swmr_mode)
    print('ipython key compilations : ',f._ipython_key_completions_())
    print('userblock size  : ',f.userblock_size)
    print('name : ',f.name)
    print('gcpl crt order : ',f._gcpl_crt_order)
    print('lapl : ',f._lapl)
    print('lcpl : ',f._lcpl)
    print('doc : ',f.__doc__)
    print('class : ',f.__class__)
    print('bool :',f.__bool__())
    print('dict : ',f.__dict__)
    print('dir :',f.__dir__())
    print('hash : ',f.__hash__())
    print('iter : ',f.__iter__())
    print('module : ',f.__module__)
    print('nonzero : ',f.__nonzero__)
    print('len : ',f.__len__())
    print('repr : ',f.__repr__())
    print('reversed : ',f.__reversed__())
    print('sizeof : ',f.__sizeof__())
    print('str : ',f.__str__())
    print('clear : ',f.clear())
    print('enter : ',f.__enter__())
    print(type(f.keys()))
    print(type(f.id))
    print(type(f.driver))
    print(type(f.attrs))
    print(type(f.items()))
    print(type(f.values()))
    print(type(f.libver))
    print(type(f.meta_block_size))
    print(type(f.mode))
    print(type(f.parent))
    print(type(f.ref))
    print(type(f.regionref))
    print(type(f.flush()))
    print(type(f.swmr_mode))
    print(type(f._ipython_key_completions_()))
    print(type(f.userblock_size))
    print(type(f.name))
    print(type(f._gcpl_crt_order))
    print(type(f._lapl))
    print(type(f._lcpl))
    print(type(f.__doc__))
    print(type(f.__class__))
    print(type(f.__bool__()))
    print(type(f.__dict__))
    print(type(f.__dir__()))
    print(type(f.__hash__()))
    print(type(f.__iter__()))
    print(type(f.__module__))
    print(type(f.__nonzero__))
    print(type(f.__len__()))
    print(type(f.__repr__()))
    print(type(f.__reversed__()))
    print(type(f.__sizeof__()))
    print(type(f.__str__()))
    print(list(f.keys()))
    print(list((f.items())))
    print(list((f.values())))
    print(list((f.parent)))
    print(type(f.__enter__()))
    print(type(f.clear()))
    print('close:',f.close())
    print(type(f.close()))
import h5py
with h5py.File('converted_keras\keras_model.h5') as file:
    print("Keys in the H5 file:")
    for key in file.keys():print(key)
    for key in file.keys():
        group = file[key];print(f"\nGroup: {key}")
        for sub_key in group.keys():print(f"  Dataset: {sub_key}")
    print(type(file.keys()))
with open('converted_keras/keras_model.h5', 'rb') as a:
    lines = a.readlines()
decoded_lines = [line.decode('ascii', errors='ignore') for line in lines]
decoded_lines
[b.decode('ascii',errors='ignore') for b in  open('converted_keras/keras_model.h5','rb').readlines()]
numeric_cols = df.columns.drop(['target'])
fig, axes = matplotlib.pyplot.subplots(nrows=len(numeric_cols), ncols=1, figsize=(12, len(numeric_cols)*5))
for i, col in enumerate(numeric_cols):seaborn.boxplot(x='target', y=col, data=df, ax=axes[i]);axes[i].set_title(f'{col} by target')
matplotlib.pyplot.tight_layout()
matplotlib.pyplot.show()
matplotlib.pyplot.figure(figsize=(10,10));matplotlib.pyplot.title('portions of the data that is cp classes 0 to 3',fontsize=10);a,b,c = matplotlib.pyplot.pie(df.cp.value_counts(),labels=(df.cp.value_counts().index),autopct='%f%%',rotatelabels=True)
for b,c in zip(b,c):c.set_rotation(b.get_rotation()),b.set_fontsize(10),c.set_fontsize(10)
behavior_os_counts = pd.crosstab(df['User Behavior Class'], df['Operating System'])
behavior_os_counts_props = behavior_os_counts.div(behavior_os_counts.sum(axis=1), axis=0)
behavior_os_counts_props.plot(kind='bar', stacked=False, figsize=(10, 5), colormap='Set3',subplots=True)
plt.title('Proportional Distribution of User Behavior Class by Operating System')
plt.xlabel('User Behavior Class')
plt.ylabel('Proportion')
plt.xticks(rotation=0)
plt.legend(title='Operating System')
plt.show()
# Optionally, you might want to limit the device models displayed to avoid a cluttered plot:
# Get the top 10 most common device models for clarity in visualization
top_device_models = df['Device Model'].value_counts().nlargest(10).index
# Filter the data to include only the top device models
filtered_data = df[df['Device Model'].isin(top_device_models)]
# Create the count plot
plt.figure(figsize=(12, 8))
sns.countplot(y='User Behavior Class', hue='Device Model', data=filtered_data, palette='PiYG')
plt.title('User Behavior Class by Device Model')
plt.xlabel('Count')
plt.ylabel('User Behavior Class')
plt.legend(title='Device Model')
plt.show()
# Create a DataFrame for the stacked bar chart
device_age_group_counts = pd.crosstab(df['Device Model'], df['age_group'])
# Normalize the counts to sum to 1 for proportional stacking
device_age_group_props = device_age_group_counts.div(device_age_group_counts.sum(axis=1), axis=0)
# Plotting the stacked bar chart
device_age_group_props.plot(kind='barh', stacked=False, figsize=(10, 5), colormap='PiYG')
plt.title('Proportional Distribution of Age Groups by Device Model')
plt.xlabel('Proportion')
plt.ylabel('Device Model')
plt.legend(title='Age Group')
plt.tight_layout()
plt.show()
# Creating a figure with subplots arranged in one row
fig, axes = plt.subplots(nrows=1, ncols=len(num_columns), figsize=(20, 5))
# Creating a custom palette
custom_palette = sns.color_palette("rainbow",3)
# Creating a boxplot for each numerical column in one row
for i, col in enumerate(num_columns):
    sns.boxplot(x=df[numeric_cols][col], ax=axes[i], palette=custom_palette)
    axes[i].set_title(f'Boxplot of {col}', fontsize=12)
# Adjusting layout to prevent overlap
plt.tight_layout()
plt.show()
# Box plots for outliers
# Creating a figure with subplots
fig, axes = plt.subplots(nrows=len(num_columns), ncols=1, figsize=(8, 10))
# Creating a boxplot for each numerical column
for i, col in enumerate(num_columns):
    sns.boxplot(x=df[numeric_cols][col], ax=axes[i], palette='plasma')
    axes[i].set_title(f'Boxplot of {col}', fontsize=12)
# Adjusting layout to prevent overlap
plt.tight_layout()
plt.show()
quantiles = df['age'].sort_values().quantile([0.25, 0.5, 0.75])
df['age_group'] = pandas.cut(df['age'].sort_values(), bins=[df['age'].sort_values().min()-1, quantiles[0.25], quantiles[0.5], quantiles[0.75], df['age'].sort_values().max()], labels=['<=28yo', '29-38yo', '39-49yo', '>49yo'])
df[['age', 'age_group']].sort_values(by=['age'])
seaborn.catplot(data=df,x='trestbps range',y='thalach range',hue='target').fig.set_size_inches(10, 10)
import os
import cv2
inn = 'New folder/Images_of_Waste/YOLO_imgs'
o = 'New folder/img'
os.makedirs(o, exist_ok=True)
alsepred = []
for f in os.listdir(inn):
    if f.endswith('.jpg'):
        print(f)
        image_path = os.path.join(inn, f)
        image = cv2.imread(image_path)
        if image is None:
            print(f"Error reading {f}")
            continue
        filename_without_extension, _ = os.path.splitext(f)
        output_path = os.path.join(o, f"{filename_without_extension}.jpg")
        cv2.imwrite(output_path, image)
        falsepred = (image, filename_without_extension)
        alsepred.append(falsepred)
model2.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['Accuracy','F1Score','FalseNegatives','FalsePositives','MeanAbsoluteError','MeanSquaredError','Precision','R2Score','Recall','RootMeanSquaredError','TrueNegatives','TruePositives'])
def find_outliers_iqr(df, column):
    # Calculate Q1 (25th percentile) and Q3 (75th percentile)
    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    IQR = Q3 - Q1  # Interquartile Range
    # Define the bounds for identifying outliers
    lower_bound = Q1 - 1.5 * IQR
    upper_bound = Q3 + 1.5 * IQR
    # Identify outliers
    outliers = df[(df[column] < lower_bound) | (df[column] > upper_bound)]
    return outliers, lower_bound, upper_bound
import tensorflow,numpy,os,matplotlib.pyplot
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from glob import glob
from PIL import Image
test = 'test'
Tained = glob(os.path.join(test,'*','*.jp*g'))
generator = ImageDataGenerator(rotation_range=20,width_shift_range=0.1,height_shift_range=0.1,shear_range=0.1,zoom_range=0.2,horizontal_flip=True,vertical_flip=True)
for image_path in Tained:
    image = tensorflow.io.read_file(image_path)
    image = tensorflow.image.decode_jpeg(image, channels=3)
    image = tensorflow.image.resize(image, (224, 224))
    image = tensorflow.cast(image, tensorflow.float32)
    image = numpy.expand_dims(image.numpy(), axis=0)
    augmented_images = generator.flow(image, batch_size=10)
    for i, augmented_image in enumerate(augmented_images):
        augmented_image = augmented_image[0]
        augmented_image = numpy.clip(augmented_image, 0, 255).astype(numpy.uint8)
        augmented_image_pil = Image.fromarray(augmented_image)
        augmented_image_pil.save(f'augmented_image_{os.path.basename(image_path).split(".")[0]}_{i+1}.jpg')
        matplotlib.pyplot.imshow(augmented_image)
        matplotlib.pyplot.axis('off')
        matplotlib.pyplot.show()
import tensorflow,numpy,os,matplotlib.pyplot
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from glob import glob
from PIL import Image
Tained = 'New folder (4)/WhatsApp Image 2024-11-18 at 00.01.32.jpeg'
generator = ImageDataGenerator(rotation_range=20,width_shift_range=0.1,height_shift_range=0.1,shear_range=0.1,zoom_range=0.2,horizontal_flip=True,vertical_flip=True)
image = tensorflow.io.read_file(Tained)
image = tensorflow.image.decode_jpeg(image, channels=3)
image = tensorflow.image.resize(image, (224, 224))
image = tensorflow.cast(image, tensorflow.float32)
image = numpy.expand_dims(image.numpy(), axis=0)
augmented_images = generator.flow(image, batch_size=10)
for i, augmented_image in enumerate(augmented_images):
    augmented_image = augmented_image[0]
    augmented_image = numpy.clip(augmented_image, 0, 255).astype(numpy.uint8)
    augmented_image_pil = Image.fromarray(augmented_image)
    augmented_image_pil.save(f'augmented_image_{os.path.basename(image_path).split(".")[0]}_{i+1}.jpg')
    matplotlib.pyplot.imshow(augmented_image)
    matplotlib.pyplot.axis('off')
    matplotlib.pyplot.show()
